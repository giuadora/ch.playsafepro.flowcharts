---
phase: 05-export-documentation
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Spielplatzinspektionen.svg
autonomous: false

must_haves:
  truths:
    - "SVG export visually matches the draw.io A4 layout (same nodes, positions, colors, fonts)"
    - "SVG renders correctly in browser at A4 proportions (794x1123px)"
    - "SVG uses Helvetica/Arial font references (no embedded fonts)"
    - "SVG contains all 16 flow nodes, 1 annotation, 20 edges, footnotes, and legend"
    - "All 4 delivery files are present and internally consistent"
  artifacts:
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Spielplatzinspektionen.svg"
      provides: "Print and web-ready vector export of A4 flowchart"
  key_links:
    - from: "Spielplatzinspektionen.svg"
      to: "Spielplatzinspektionen.drawio"
      via: "SVG node positions and styles match draw.io XML exactly"
---

<objective>
Generate a new SVG export from the draw.io A4 layout, then verify all deliverables are complete and consistent.

Purpose: Complete the delivery package with a print+web ready SVG that matches the A4 flowchart, and verify the entire package before shipping.
Output: Final SVG export and verified delivery package.
</objective>

<execution_context>
@/Users/jean-pierrekoenig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jean-pierrekoenig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-export-documentation/05-CONTEXT.md
@.planning/phases/05-export-documentation/05-01-SUMMARY.md
@.planning/phases/04-a4-layout-typography/04-02-SUMMARY.md
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Spielplatzinspektionen.drawio
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate SVG export from draw.io A4 layout</name>
  <files>
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Spielplatzinspektionen.svg
  </files>
  <action>
    Generate a new SVG file that faithfully reproduces the draw.io A4 layout. Since draw.io desktop is not installed, construct the SVG manually from the draw.io XML source (same approach as Phase 3).

    **SVG canvas:**
    - Width: 794, Height: 1123 (A4 at 96 DPI)
    - Background: white (#FFFFFF) — clean for both print and web display
    - No page border (Claude's discretion: transparent border is cleaner for web while white background ensures print clarity)
    - Font: Helvetica, Arial, sans-serif (reference only, no embedding per user decision)

    **Read the draw.io XML to extract exact coordinates for all elements.** The draw.io file is the source of truth. For each mxCell:
    - Extract x, y, width, height from mxGeometry
    - Extract style properties (fillColor, strokeColor, fontColor, fontSize, shape, rounded, etc.)
    - Extract value (the displayed text, with HTML tags converted to SVG tspan elements)

    **Node rendering rules by shape type:**
    - `rounded=1;arcSize=50` -> rounded rectangle (rx/ry = height/2) for START, N04, E00, END
    - `rhombus` -> diamond (rotated square via polygon) for D01, D02
    - `shape=parallelogram` -> skewed parallelogram (polygon with 4 points, top shifted right) for E04, DOK
    - Default rectangle -> standard rect for all other nodes
    - `text` with `fontStyle=2` -> italic annotation for NOTE
    - `text` with `fontStyle=1` -> bold title for title element
    - `dashed=1` -> dashed border for brand placeholder

    **Color palette (from Phase 4 draw.io):**
    - Gray (start/end): fill=#E9ECEF, stroke=#6C757D, text=#343A40
    - Blue (new playground): fill=#D6E4F0, stroke=#2B579A, text=#1F3864
    - Green (inspections): fill=#DFF0D8, stroke=#3C763D, text=#2D572C
    - Yellow (post-inspection): fill=#FFF3CD, stroke=#856404, text=#533F03
    - Info boxes: fill=#F8F9FA, stroke=#DEE2E6, text=#495057

    **Edge rendering:**
    - All edges use orthogonal routing (right-angle paths)
    - Stroke width: 1.5 (matching draw.io strokeWidth)
    - Arrowhead marker at end
    - Edge colors match source node section color
    - Dashed edges (e8 loop-back, eNOTE annotation) use stroke-dasharray
    - Edge labels positioned at midpoint of edge path
    - Read waypoint arrays from draw.io XML for edges that have explicit routing (e3, e8, e13, e15)

    **Text rendering:**
    - Convert HTML line breaks (`<br>`) to SVG tspan elements with dy offsets
    - Font sizes match draw.io: 12pt title, 9pt node text, 8pt edge labels and footnotes/legend
    - Text anchor: middle for nodes, start for footnotes/legend (align=left)
    - Handle multi-line text properly with tspan positioning

    **Elements to include (22 total from draw.io):**
    Metadata: title, brand, footer
    Flow nodes: START, D01, N01, N02, D02, N03, N04, E00, E01, E02, E03, E04, P01, MASS_KAT, MASS_UMS, DOK, END
    Annotation: NOTE
    Info boxes: FOOTNOTES, LEGEND
    Edges: e1-e20, eNOTE

    **SVG structure:**
    1. XML declaration and SVG root with viewBox="0 0 794 1123"
    2. defs section with arrowhead marker and CSS classes
    3. White background rect
    4. Groups organized by section (metadata, blue path, green path, yellow path, info boxes)
    5. Edges rendered after nodes (so labels appear on top)

    **Quality checks before writing:**
    - All node positions match draw.io mxGeometry exactly
    - All colors match draw.io style properties exactly
    - All text content matches draw.io value properties exactly
    - Edge routing follows draw.io waypoints where specified
    - SVG is valid XML (all tags closed, attributes quoted)
  </action>
  <verify>
    - SVG file exists at new path
    - SVG root has width="794" height="1123"
    - Contains 16 flow node shapes + 1 annotation text + 3 metadata + 2 info boxes
    - Contains 21 edge paths (e1-e20 + eNOTE)
    - Uses Helvetica/Arial font family
    - No references to old node IDs (D03, P02, D04, P04, P03, D05, P05, P06, P07, D06)
    - Valid XML (no unclosed tags)
    - File opens in browser without errors
  </verify>
  <done>SVG export matches draw.io A4 layout with all 22 elements, correct colors, positions, and fonts</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete v1.1 delivery package with all 4 files renamed and updated:
    1. Spielplatzinspektionen.drawio — A4 layout from Phase 4 (renamed)
    2. Spielplatzinspektionen.svg — New SVG export matching A4 layout
    3. Spielplatzinspektionen.md — Mermaid source with simplified structure
    4. README.md — Full German refresh with v1.1 content

    All files in folder: Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/
    Project root: ch.playsafepro.flowcharts/
  </what-built>
  <how-to-verify>
    1. Open Spielplatzinspektionen.svg in browser — verify it matches the draw.io layout visually (same nodes, colors, positions, A4 proportions)
    2. Open Spielplatzinspektionen.drawio in draw.io — confirm it still loads correctly after rename
    3. Paste the Mermaid code block from Spielplatzinspektionen.md into https://mermaid.live — verify it renders without errors and shows the simplified structure
    4. Read README.md — check file references use new names, colors match Phase 4, contact info is correct (info@psp.live, playsafepro.ch), no phone number, CC BY-NC 4.0 license
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks and checkpoint complete:
1. SVG visually matches draw.io A4 layout
2. Mermaid renders in GitHub preview (validated via mermaid.live)
3. README has correct file names, colors, contact info
4. draw.io file loads after rename
5. All 4 files present in delivery folder
6. User has approved the complete package
</verification>

<success_criteria>
- SVG export regenerated matching A4 layout (EXPORT-01 complete)
- User has verified all deliverables are correct and consistent
- Delivery package is ready for GitHub publishing
</success_criteria>

<output>
After completion, create `.planning/phases/05-export-documentation/05-02-SUMMARY.md`
</output>
