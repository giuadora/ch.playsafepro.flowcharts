---
phase: 09-documentation-quality-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md
  - README.md
autonomous: true

must_haves:
  truths:
    - "Both flowchart legends include the subprocess symbol entry"
    - "Each flowchart's 'Als PDF herunterladen' QR encodes its own PDF URL"
    - "Both flowcharts' 'Als Vorlage verwenden' QR encodes the shared README URL"
    - "Package README lists both flowcharts (Neuer-Spielplatz + Bestehender-Spielplatz) instead of single Spielplatzinspektionen"
    - "Root README lists both flowcharts with correct file names"
  artifacts:
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio"
      provides: "Legend with subprocess symbol, QR codes pointing to FC1 PDF and shared README"
      contains: "Unterprozess"
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio"
      provides: "Legend with subprocess symbol, QR codes pointing to FC2 PDF and shared README"
      contains: "Unterprozess"
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md"
      provides: "Package README describing both flowcharts"
      contains: "Neuer-Spielplatz"
    - path: "README.md"
      provides: "Root README with updated file listing"
      contains: "Bestehender-Spielplatz"
  key_links:
    - from: "QR1 in Neuer-Spielplatz.drawio"
      to: "Neuer-Spielplatz.pdf"
      via: "QR code encoded URL"
    - from: "QR1 in Bestehender-Spielplatz.drawio"
      to: "Bestehender-Spielplatz.pdf"
      via: "QR code encoded URL"
    - from: "QR2 in both drawio files"
      to: "README.md in delivery package"
      via: "QR code encoded shared URL"
---

<objective>
Update legends, QR codes, and documentation to complete the v2.0 flowchart split.

Purpose: Both flowcharts need the subprocess symbol in their legend (DOC-01), each QR code must point to the correct file (FILE-02, FILE-03), and both READMEs must reflect the two-flowchart structure (DOC-02, DOC-03).
Output: Updated drawio files with correct legends and QR codes, updated package README, updated root README.
</objective>

<execution_context>
@/Users/jean-pierrekoenig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jean-pierrekoenig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-flowchart-split-file-structure/07-01-SUMMARY.md
@.planning/phases/08-node-modifications-norm-compliance/08-01-SUMMARY.md
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add subprocess symbol to legend in both flowcharts and update QR codes</name>
  <files>
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
  </files>
  <action>
  **Part A: Legend update (DOC-01)**

  In BOTH Neuer-Spielplatz.drawio and Bestehender-Spielplatz.drawio, find the LEGEND mxCell and add a subprocess symbol entry to the shapes section.

  Current legend value contains (HTML-encoded):
  ```
  ▭ Rechteck = Prozessschritt / Aktion
  ◇ Raute = Entscheidungspunkt
  ⬭ Abgerundetes Rechteck = Start / Ende
  ▱ Parallelogramm = Dokument / Bericht
  ```

  Add after the Parallelogramm line:
  ```
  ⊞ Unterprozess = Vordefinierter Prozess
  ```

  The HTML-encoded value in the mxCell should become:
  `▭ Rechteck = Prozessschritt / Aktion&lt;br&gt;◇ Raute = Entscheidungspunkt&lt;br&gt;⬭ Abgerundetes Rechteck = Start / Ende&lt;br&gt;▱ Parallelogramm = Dokument / Bericht&lt;br&gt;⊞ Unterprozess = Vordefinierter Prozess`

  Also increase the LEGEND mxGeometry height from 115 to 130 to accommodate the extra line.

  **Part B: QR code updates (FILE-02, FILE-03)**

  The QR codes are embedded as base64 PNG images in both drawio files. The current QR codes point to the old single-file URLs from v1.2 (Spielplatzinspektionen.pdf and Spielplatzinspektionen README).

  The GitHub repo is: `https://github.com/giuadora/ch.playsafepro.flowcharts`
  The delivery folder is: `Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden`

  **QR1 ("Als PDF herunterladen")** must point to each flowchart's own PDF:
  - FC1 (Neuer-Spielplatz.drawio): QR1 URL = `https://github.com/giuadora/ch.playsafepro.flowcharts/raw/main/Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.pdf`
  - FC2 (Bestehender-Spielplatz.drawio): QR1 URL = `https://github.com/giuadora/ch.playsafepro.flowcharts/raw/main/Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.pdf`

  **QR2 ("Als Vorlage verwenden")** must point to the shared README (same URL in both):
  - Both: QR2 URL = `https://github.com/giuadora/ch.playsafepro.flowcharts/blob/main/Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md`

  To generate QR codes as base64 PNG, use Python's `qrcode` library:
  ```python
  import qrcode
  import base64
  from io import BytesIO

  def make_qr_base64(url):
      qr = qrcode.QRCode(version=1, box_size=5, border=2)
      qr.add_data(url)
      qr.make(fit=True)
      img = qr.make_image(fill_color="black", back_color="white")
      buf = BytesIO()
      img.save(buf, format="PNG")
      return base64.b64encode(buf.getvalue()).decode()
  ```

  If `qrcode` is not installed, install it: `pip3 install qrcode[pil]`

  Replace the base64 image data in each QR1 and QR2 mxCell's `image=data:image/png;base64,{BASE64_DATA}` with the newly generated QR code data.

  **Important:** The QR1 image data must be DIFFERENT between FC1 and FC2 (each points to its own PDF). The QR2 image data is IDENTICAL in both files (both point to shared README).
  </action>
  <verify>
  1. Parse both drawio files with Python XML parser — must be well-formed XML
  2. In both files, verify LEGEND value contains "Unterprozess"
  3. In both files, verify LEGEND height is 130
  4. Decode the QR1 base64 PNG in Neuer-Spielplatz.drawio and verify it encodes the FC1 PDF URL
  5. Decode the QR1 base64 PNG in Bestehender-Spielplatz.drawio and verify it encodes the FC2 PDF URL
  6. Decode the QR2 base64 PNG and verify both files encode the shared README URL
  </verify>
  <done>
  Both flowcharts have subprocess symbol in legend (DOC-01). Each flowchart's QR1 points to its own PDF (FILE-02). Both QR2 codes point to shared README (FILE-03). All files are valid draw.io XML.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update package README and root README for two-flowchart structure</name>
  <files>
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md
    README.md
  </files>
  <action>
  **Part A: Package README update (DOC-02)**

  Update `Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md` to reflect the two-flowchart structure:

  1. **Title section (line ~7-12):** Update the intro paragraph to describe two flowcharts instead of one:
     - Mention FC1 (Neuer Spielplatz) covers the commissioning path from construction acceptance through installation inspection to opening
     - Mention FC2 (Bestehender Spielplatz) covers the ongoing inspection cycle with three inspection types

  2. **Version:** Update from "Version 1.2" to "Version 2.0"

  3. **File table (line ~17-25):** Replace the single-file listing with the two-flowchart listing:

     | Datei | Format | Beschreibung |
     |-------|--------|--------------|
     | Neuer-Spielplatz.drawio | draw.io | Editierbares Diagramm — Neuer Spielplatz (Inbetriebnahme) |
     | Neuer-Spielplatz.svg | SVG | Vektorgrafik — Neuer Spielplatz |
     | Neuer-Spielplatz.pdf | PDF | Druckfertige Version (DIN A4) — Neuer Spielplatz |
     | Bestehender-Spielplatz.drawio | draw.io | Editierbares Diagramm — Bestehender Spielplatz (Inspektionszyklus) |
     | Bestehender-Spielplatz.svg | SVG | Vektorgrafik — Bestehender Spielplatz |
     | Bestehender-Spielplatz.pdf | PDF | Druckfertige Version (DIN A4) — Bestehender Spielplatz |
     | Spielplatzinspektionen.md | Mermaid | Diagramm-Quellcode für technische Nutzer |
     | README.md | Markdown | Diese Anleitung |

  4. **Draw.io instructions (line ~29-73):** Update file references from `Spielplatzinspektionen.drawio` to reference both files: `Neuer-Spielplatz.drawio` and `Bestehender-Spielplatz.drawio`. Keep instructions generic where possible.

  5. **Shapes section (line ~63-68):** Add subprocess symbol to the shape list:
     - **Doppelt umrandetes Rechteck** = Unterprozess (vordefinierter Prozess)

  6. **SVG section (line ~179-186):** Update from `Spielplatzinspektionen.svg` to mention both SVG files.

  7. **Footer (line ~210-215):** Update version to 2.0.

  **Part B: Root README update (DOC-03)**

  Update `README.md` (root) to list both flowcharts:

  1. Replace the file table with the two-flowchart listing:

     | Datei | Format | Beschreibung |
     |-------|--------|--------------|
     | `Neuer-Spielplatz.drawio` | draw.io | Editierbares Diagramm — Neuer Spielplatz |
     | `Neuer-Spielplatz.svg` | SVG | Vektorgrafik — Neuer Spielplatz |
     | `Neuer-Spielplatz.pdf` | PDF | Druckfertige Version (DIN A4) — Neuer Spielplatz |
     | `Bestehender-Spielplatz.drawio` | draw.io | Editierbares Diagramm — Bestehender Spielplatz |
     | `Bestehender-Spielplatz.svg` | SVG | Vektorgrafik — Bestehender Spielplatz |
     | `Bestehender-Spielplatz.pdf` | PDF | Druckfertige Version (DIN A4) — Bestehender Spielplatz |
     | `Spielplatzinspektionen.md` | Mermaid | Diagramm-Quellcode |
     | `README.md` | Markdown | Anleitung zur Bearbeitung und Verwendung |

  2. Update the intro text to mention two separate flowcharts covering new playgrounds and ongoing inspections respectively.

  **Important:** Preserve existing PSP logo header, Kontakt section, Lizenz section, and giuadora footer in both READMEs. Keep all Matomo tracking URLs unchanged. Keep the German language throughout.
  </action>
  <verify>
  1. Package README contains "Neuer-Spielplatz" and "Bestehender-Spielplatz" file references
  2. Package README contains "Unterprozess" in shapes section
  3. Package README version is "2.0"
  4. Root README lists both flowchart files
  5. Both READMEs still contain PSP logo header and contact info
  6. No broken Markdown formatting (check with `cat` that tables render correctly)
  </verify>
  <done>
  Package README describes both flowcharts with correct file names and subprocess shape (DOC-02). Root README lists both flowcharts (DOC-03). Both READMEs maintain PSP branding and German language.
  </done>
</task>

</tasks>

<verification>
1. Both drawio files parse as valid XML
2. LEGEND in both files contains "Unterprozess" (DOC-01)
3. QR1 in FC1 encodes Neuer-Spielplatz.pdf URL (FILE-02)
4. QR1 in FC2 encodes Bestehender-Spielplatz.pdf URL (FILE-02)
5. QR2 in both files encodes shared README URL (FILE-03)
6. Package README lists both flowcharts and mentions subprocess (DOC-02)
7. Root README lists both flowcharts (DOC-03)
</verification>

<success_criteria>
- DOC-01: Subprocess symbol appears in legend of both flowcharts
- DOC-02: Package README describes both flowcharts
- DOC-03: Root README lists both flowcharts
- FILE-02: Each QR1 points to its own PDF
- FILE-03: Both QR2 point to shared README
- All files are valid XML/Markdown
</success_criteria>

<output>
After completion, create `.planning/phases/09-documentation-quality-verification/09-01-SUMMARY.md`
</output>
