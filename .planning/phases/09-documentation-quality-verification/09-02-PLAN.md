---
phase: 09-documentation-quality-verification
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
  - Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
autonomous: false

must_haves:
  truths:
    - "Both flowcharts pass center alignment verification"
    - "All arrows in both flowcharts are connected — no dangling edges"
    - "Margins maintained on all edges in both flowcharts"
    - "No node overlaps in either flowchart"
    - "Footer with 3-column corporate layout present in both flowcharts"
    - "PSP logo and branding present in both flowcharts"
  artifacts:
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio"
      provides: "Quality-verified FC1 flowchart"
    - path: "Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio"
      provides: "Quality-verified FC2 flowchart"
  key_links:
    - from: "All edge elements"
      to: "Node elements via source/target attributes"
      via: "mxCell edge source/target ID references"
---

<objective>
Run automated quality checks and visual verification on both flowcharts.

Purpose: Ensure both flowcharts meet all quality gates (QA-01 through QA-06) before shipping v2.0. This includes automated XML-level checks for edge connectivity, node overlap detection, margin verification, and branding presence — plus a human visual verification checkpoint.
Output: Both flowcharts confirmed quality-verified and ready for export.
</objective>

<execution_context>
@/Users/jean-pierrekoenig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jean-pierrekoenig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-documentation-quality-verification/09-01-SUMMARY.md
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
@Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run automated quality checks on both flowcharts</name>
  <files>
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
  </files>
  <action>
  Write and run a Python script that performs the following quality checks on BOTH drawio files. Parse each file as XML (xml.etree.ElementTree).

  **QA-02: Arrow connectivity check**
  - Find all mxCell elements with `edge="1"`
  - For each edge, verify `source` and `target` attributes exist AND reference valid node IDs (mxCell elements with `vertex="1"`)
  - Report any dangling edges (missing source/target or pointing to non-existent nodes)

  **QA-04: Node overlap check**
  - Extract bounding boxes (x, y, width, height from mxGeometry) for all vertex mxCells
  - Check for overlapping rectangles (intersection of any two node bounding boxes)
  - Ignore edges, text labels, and container elements (like root cells with id="0" or id="1")
  - Report any overlapping node pairs

  **QA-05: Footer check**
  - Verify existence of 3-column footer cells (look for mxCells containing "playsafepro" or "giuadora" or "Sonnenstrasse" in their value)
  - Confirm at least 3 footer-related cells exist

  **QA-06: PSP logo check**
  - Verify existence of a mxCell with `shape=image` containing "playsafepro" in the image URL
  - Confirm PSP logo is present

  **QA-03: Margin check**
  - For all vertex nodes, verify no node has x < 20 or y < 20 (minimum margin from page edge)
  - Verify no node extends beyond x + width > 774 or y + height > 1103 (A4 bounds minus margin)
  - Page size is 794x1123 pixels

  **QA-01: Center alignment**
  - Calculate the bounding box of all flow nodes (exclude footer, footnotes, legend, QR codes — filter by y position, only nodes with y < 800)
  - Verify the horizontal center of this bounding box is within 40px of page center (397)

  Print a clear PASS/FAIL report for each check. If any check fails, describe what needs manual fixing, but do NOT auto-fix — flag for human review.

  If all checks pass, no file modifications needed. If any check fails, apply automated fixes where safe (e.g., adjusting a node position by a few pixels to fix margin violation), and re-run verification.
  </action>
  <verify>
  Script runs without errors. All 6 quality checks report PASS for both FC1 and FC2.
  </verify>
  <done>
  All automated quality checks pass: connected arrows (QA-02), no overlaps (QA-04), footer present (QA-05), PSP logo present (QA-06), margins maintained (QA-03), center-aligned (QA-01).
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of both flowcharts in draw.io</name>
  <files>
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Neuer-Spielplatz.drawio
    Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/Bestehender-Spielplatz.drawio
  </files>
  <action>
  Present both flowcharts for human visual verification. No automated changes in this task — only human inspection.

  What was built (across Plan 01 and Task 1 of this plan):
  - Subprocess symbol (⊞) in legend of both flowcharts (DOC-01)
  - Correct QR codes: each "Als PDF herunterladen" QR points to its own PDF, both "Als Vorlage verwenden" QR codes point to shared README (FILE-02, FILE-03)
  - Updated package README describing both flowcharts (DOC-02)
  - Updated root README with new file listing (DOC-03)
  - All automated quality checks passed (QA-01 through QA-06)

  Human verification steps:

  **FC1: Neuer-Spielplatz.drawio**
  1. Open in draw.io (Desktop or https://app.diagrams.net)
  2. Legend box: confirm "⊞ Unterprozess = Vordefinierter Prozess" appears as a new line
  3. Legend box: confirm no text is cut off, all entries visible
  4. Overall layout: confirm nothing overlaps, arrows connect properly
  5. Footer: confirm 3-column PSP corporate footer is present and readable
  6. QR codes: visible in footer area

  **FC2: Bestehender-Spielplatz.drawio**
  7. Open in draw.io
  8. Legend box: confirm "⊞ Unterprozess = Vordefinierter Prozess" appears
  9. Overall layout: confirm nothing overlaps, arrows connect properly
  10. Footer: confirm 3-column PSP corporate footer is present and readable
  11. QR codes: visible in footer area

  **READMEs:**
  12. Open Inspektion-von-Spielplatzgeraeten-und-Spielplatzboeden/README.md — confirm both flowcharts listed, version 2.0, subprocess shape mentioned
  13. Open README.md (root) — confirm both flowcharts listed
  </action>
  <verify>
  User types "approved" or describes issues to fix.
  </verify>
  <done>
  Human has visually verified both flowcharts and both READMEs. All Phase 9 requirements confirmed complete.
  </done>
</task>

</tasks>

<verification>
1. All 6 automated QA checks pass for both flowcharts
2. Human visually confirms legend, layout, footer, QR codes in both flowcharts
3. Human confirms both READMEs are correct
</verification>

<success_criteria>
- QA-01: Center alignment verified for both flowcharts
- QA-02: All arrows connected in both flowcharts
- QA-03: Margins maintained in both flowcharts
- QA-04: No node overlaps in either flowchart
- QA-05: 3-column corporate footer present in both flowcharts
- QA-06: PSP logo and branding present in both flowcharts
- Human visual approval received
</success_criteria>

<output>
After completion, create `.planning/phases/09-documentation-quality-verification/09-02-SUMMARY.md`
</output>
